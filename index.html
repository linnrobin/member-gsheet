<!DOCTYPE html>
<html>
<head>
  <title>Google Sheets API with OAuth</title>
  <script src="https://apis.google.com/js/api.js"></script>
  <script src="https://accounts.google.com/gsi/client" async defer></script>
</head>
<body>
  <h1>Google Sheets API + OAuth</h1>
  <button id="authorize-btn">Authorize and Fetch Data</button>
  <pre id="output">Waiting...</pre>

  <script>
    const CLIENT_ID = '777842538509-b30eqog08ovtacuqvdh7g4oe8ej2c7k0.apps.googleusercontent.com';
    const API_KEY = ''; // Not required unless you have a quota issue
    const SHEET_ID = '1bVnJwShGvmGR5W5NZ3vBSeKFhlWuzC8ej13lY3kldSY';
    const RANGE = 'Sheet1!A1:D10';
    const DISCOVERY_DOC = 'https://sheets.googleapis.com/$discovery/rest?version=v4';
    const SCOPES = 'https://www.googleapis.com/auth/spreadsheets.readonly';

    let tokenClient;
    let gapiInited = false;

    document.getElementById('authorize-btn').onclick = handleAuthClick;

    // Load the Google API client
    function gapiLoaded() {
      gapi.load('client', async () => {
        await gapi.client.init({
          apiKey: API_KEY,
          discoveryDocs: [DISCOVERY_DOC],
        });
        gapiInited = true;
        console.log("GAPI client initialized.");
      });
